<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>会员中心</title>
    <link rel="stylesheet" type="text/css" href="/static/theme/memberTheme/theme1/member/css/reset.css?v=20170715">
    <link rel="stylesheet" type="text/css" href="/static/theme/memberTheme/theme1/member/css/hpn-common.css">
    <link rel="stylesheet" type="text/css" href="/static/theme/memberTheme/theme1/member/css/index.css?v=20171117">
    <link rel="stylesheet" type="text/css" href="/static/theme/memberTheme/theme1/member/css/global.css">
    <script>
        <!--
//        window.onerror=function(){return true;}
        // -->
    </script>
    <script>
    <!--
    // 屏蔽JS错误
//    window.onerror = function(){return true;}
    // -->
</script>
<script>
    var CONFIG = {
        BASEURL: "/",    // 根路径
        RESURL: "/static/theme/memberTheme/theme1/"         // 资源路径
    };
</script>
<script src="/static/theme/memberTheme/theme1/js/mobile-detect.min.js"></script><script>
    var fengge1 = 'f42023';
</script>
<style>

        .reResulttBg{background: #f42023;} 
        .process .layout .monty ul li,.process .layout .list_tems .date:after,.list ul li .slide p.acti,.headmemberbg{background: #f42023;}
        .process .layout .list_tems .date span, .process .layout .list_tems .date h3,.eveb_amount span,.color-e77c3c,.eveb_setting_table a,.xieyiCss，.gcdtgd{color: #f42023!important;}
        .eveb_sub_nav_type a:hover, .eveb_sub_nav_type li.on a:link, .eveb_sub_nav_type li.on a:visited{color: #f42023!important;font-weight: 700;border-bottom-color: #e1e1e1;background: #f8f8f8;}
        .list ul li .slide p:hover,.letterbtn-bg{background: #f42023!important;color: white;}
        .list h3 a{background: #f42023;border-bottom: 3px solid #a92309; height: 47px; line-height: 47px;}
        .help_l_menu li .t.sli{border-left: 5px solid #f42023;}
        .withdraw-bg-input{border: 2px solid #f42023!important;}
        .clearBet_template .l span i{background: #f42023 url(/static/theme/memberTheme/theme1//img/tm-mdl-icon.png) no-repeat!important; border-radius: 50%;background-position: 0 41%!important;}



        .eveb_nav_sub .on,.button_1, .button_1:link, .button_1:visited,.alert_col h5,.onlineService,.layui-layer-popup .layui-layer-title,.xzqd,.xzqdlskj,.game_name .box2_stage p span i.acti,.Betting,.Single,.list_ject ul li .Result p a.acti,.list_ject ul li .Result p a.acti:hover,.top{background:#f42023!important}
        .eveb_nav_sub .on a,.bankInfo .name,.help_l_menu .title p .sum,.help_r_main .light,.game_name .box2_stage p span i,.game_name .box1_name  p i,.Account p a.red{color:#f42023!important}
        .eveb_nav_sub .on,.game_name .box2_stage p span{border:1px solid #f42023!important;}
        .eveb_nav_sub .on,.game_name .box2_stage p span i.acti{color:#fff!important;}
        .eveb_nav_sub .on a{border-top:1px #f42023 solid!important;}
        .eveb_nav_sub ul{border-bottom:1px #f42023 solid!important;}
        #apptop{background: #f42023}
        .alert_col div::-webkit-scrollbar-thumb {background-color: #f42023!important;}

        
       /* .men_list{background-color: #f42023!important;}
        .main_layout .left_layout h1{background-color: #f42023!important;}
        .men_list .nav_list ul li:after{background-color: #f42023!important;}
        .main_layout .right_layotu .right_wrap .login ul li button{background-color: #f42023!important;border-bottom: 2px solid #f42023!important;}
        .main_layout .right_layotu .right_wrap .down_file{background-color: #f42023!important;}
        .main_layout .right_layotu .left_wrap .Bettingbag .num_bett .val_add p.fr a.a1{background-color: #f42023!important;border-bottom: 2px solid #f42023!important;}
        .main_layout .right_layotu .chart .title h2{background-color: #f42023!important;border-bottom: 2px solid #f42023!important;}
        .main_layout .right_layotu .chart .title{border-bottom: 1px solid #f42023!important;}
        .main_layout .right_layotu .chart .title a{color: #f42023!important;}
        .main_layout .right_layotu .left_wrap .tabs_cg ul li.acti i{border-left: 1px solid #f42023!important;  border-right: 1px solid #f42023!important;}
        .main_layout .right_layotu .left_wrap .tabs_cg ul li.acti{border-top: 3px solid #f42023!important;}
        .main_layout .right_layotu .left_wrap .tabs_cg{border-bottom: 1px solid #f42023!important;}
        .main_layout .left_layout ul li i.i0{background-color: #f42023!important;}
        .main_layout .left_layout ul li i.i0:after{border-right: 8px solid #f42023!important;}
        .main_layout .right_layotu .right_wrap .Notice b{color: #f42023!important;}
        .main_layout .right_layotu .right_wrap .login h2 p{border-bottom: 2px solid #f42023!important;}
        .main_layout .right_layotu .right_wrap .login h2{border-bottom: 1px solid #f42023!important;}
        .record{border-top: 2px solid #f42023!important;}*/



    </style>
<style>


        .head div h5,.Betting .tabs ul li,.top .nav h1{background:#d51910!important}
        .jf_box .url a,.eveb_form label.error,.eveb_transfer_box .center_wallet .money,.eveb_transfer_box .wallet_list li p{color:#d51910!important}
        .Betting .tabs ul li.acti{background:#fff!important}
        .button_1, .button_1:link, .button_1:visited{border:1px solid #d51910!important;}
    </style>
</head>
<body><div class="help_r_main">
    <div class="eveb_content">
        <div class="eveb_transfer_box mb20 clearfix" style="overflow: visible;">
            <div class="center_wallet fl rel">
                <span>账户总余额</span>
                <p class="money"><strong id="wallet" class="money">{$user->coin}</strong>元</p>
                <div class="abs Res" onclick="refreshMoney()"><i class="icon resIcon"></i></div>
            </div>
            <ul class="wallet_list wallet_list2 fl">
                <li><span>可提款总额</span>
                    <p id="wallet_1" class="money">{$user->coin - $user->fcoin}</p></li>
                <!--<li class="rel">
                    <a href="javascript:void(0)" class="color-df3c31">资金归集</a>
                    <p><i class="icon tipIcon"></i></p>
                    <div class="tipBox abs">
                        <span class="caret abs"></span>
                        可将各个平台零钱全部转入中心钱包，方便取款
                    </div>
                </li>-->
            </ul>
        </div>
        <form id="form1" novalidate="novalidate" method="post" onkeyup="if(event.keyCode === 13) my_validate()">
        	{if($user->bank->empty())}
            <ul class="eveb_form management_bank">
                <div class="mb10 color-888"><font color="#999999">您还未绑定银行卡 请绑定银行卡，</font><a href="javascript:void(0)" onclick="parent.goSubUrl('/user/bank')" style="color:#ff7800">点击前往&gt;&gt;</a></div>
            </ul>
            {else/}			
			<ul class="eveb_form management_bank">
				<div class="mb10 color-888">转到银行卡：<label for="id" class="error" style="display: none;"></label></div>
				<li>
				<input type="hidden" name="real_amount" >
				<input type="hidden" name="debit_amount" >
				<input type="hidden" name="audit_remain" value="{$user->audit_flow}">
				<input type="hidden" name="bank_name" value="{$user->bank_name}">
				<input type="hidden" name="bank_account" value="{$user->bank_account}">
				<input type="hidden" name="bank_address" value="{$user->bank_address}">
				<input type="hidden" name="bank_username" value="{$user->bank_username}">

					<div class="item w106"><input type="radio" checked="checked" class="valid"></div>
					<div class="item w125 color-e77c3c" style="width:30px">默认</div>
					<div id='bank_name' class="item w105">{$user->bank_name}</div>
					<div id='bank_username' class="item w105">{$user->bank_username}</div>
					<div id='bank_account' class="item w205 accountSubStr" data-bank="{$user->bank_account}">
						{$user->bank_account}
					</div>
					<div id='bank_address' class="item w230">{$user->bank_address}</div>
					<!--
					<div class="item">
						<a href="javascript:void(0)" class="mr10 color-c4463c" onclick="setDefault(103268)">设为默认</a>
						<a href="javascript:void(0)" class="icon deleteIcon2" onclick="ajaxDel(103268)"></a>
					</div>
					-->
				</li>
			</ul>
			<ul class="eveb_form eveb_withdraw">
                <li>
                    <span>提款金额：</span>
                    <input id="money" class="withdraw-bg-input" name="amount" type="text" placeholder="请输入转账金额"
                           style="border: 2px solid #f49c42;background: #faf9f9;height: 28px; padding-left:5px" autocomplete="nope">
                    <label id="error_money" class="error"></label>
                </li>
                 <li>
                    <span>资金密码：</span>
                    <input id="password" class="withdraw-bg-input" name="coinPassword" type="password" placeholder="请输入资金密码"
                           style="border: 2px solid #f49c42;background: #faf9f9;height: 28px; padding-left:5px" autocomplete="new-password">
                    <label id="error_password" class="error"></label>
                </li>

                </ul>
            <div class="eveb_form_submit">
                <button type="button" class="button_medium button_1" onclick="my_validate()">提交</button>
                <input type="reset" value="重置" class="ml_10 button_medium button_1 button_3" style="color: white;">
            </div>
			{/if}
        </form>
    </div>
</div>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/js/jquery.min.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/framework/jquery.validate.min.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/laydate/laydate.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/js/validate.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/js/global.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/js/jquery.form.min.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/js/jquery.md5.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/js/global.js?v=3.0"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/layer/layer.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/js/jquery.nicescroll.js"></script>
<script type="text/javascript" src="/static/theme/memberTheme/theme1/member/js/clipboard.min.js"></script>
<script src="/static/theme/memberTheme/theme1/js/dateFormat.js"></script>
<script src="/static/theme/memberTheme/theme1/js/template.js"></script>
<script src="/static/theme/memberTheme/theme1/js/jquery.cookie.js"></script><!--自定义封装函数-->
<script src="/static/theme/memberTheme/theme1/js/jquery.md5.js"></script><!--自定义封装函数-->
<script>
    function my_validate() {
        var _amount = $('#money').val();      // 金额
        $(".error").html('');
        if(_amount === ''){
            $("#error_money").html("* 请输入取款金额!");
            return false;
        }
        if($("#password").val() === ''){
            $("#error_password").html("* 请输入取款密码!");
            return false;
        }
        parent.showLoading();
        var flag = false;
         $.ajax({
            url: "/user/get_withdraw_password",
            dataType:'json',
            type:'GET',
            async: false,
            success:function (data) {
               if(data.code==3){
                    alert("还未绑定取款密码,点击前往绑定");
                    setTimeout(function () {
                        window.location.href = "/user/save_coinpassword";
                    },250);

                    flag = true;
                }
            }
        });
         if(flag)return;

        $.ajax({
            url: "/user/get_withdraw_info",
            data: {amount:_amount},
            dataType:'json',
            type:'GET',
            async: false,
            success:function (data) {
                $('[name="audit_remain"]').val(data.data.audit_remain);
                $('[name="amount"]').val(data.data.amount);
                $('[name="real_amount"]').val(data.data.real_amount);
                $('[name="debit_amount"]').val(data.data.debit_amount);
            },
            error:function (err) {
                console.log(err);
                alert('ajax error');
                flag = true;
            },
            complete:function () {
                parent.hideLoading();
            }
        });
        if(flag)return;

        $('#form1').submit();
    }

    $(function() {
        // 底部信息调用
        function ajaxGetDbxx() {
            ajaxRequest({
                url: CONFIG.BASEURL + "ajaxGetWebInfo.json",
                success: function (json) {
                    if (json.result != 1) {
                        return;
                    }
                    $(".webDbxx").html(json.webDbxx);
                }
            });
        }

        if ($(".webDbxx").length > 0) {
            ajaxGetDbxx();
        }

        parent.hideLoading();

        $(".errhide").addClass('hide');
        $("#money").keyup(function () {
            var obj = this;
            obj.value = obj.value.replace(/[^\d.]/g, "");
            obj.value = obj.value.replace(/^\./g, "");
            obj.value = obj.value.replace(/^0/g, "");
            obj.value = obj.value.replace(/\.{2,}/g, ".");
            //确保只有一次小数点出现
            obj.value = obj.value.replace(".", "#").replace(/\./g, "").replace("#", ".");
            //确保小数点后是两位数字
            if (obj.value.indexOf(".") > 0 && obj.value.indexOf(".") + 4 <= obj.value.length) {
                obj.value = obj.value.substr(0, obj.value.indexOf(".") + 3);
            }
            $("#money").val(obj.value);

            //提示非法金额输入
            var maxMoney=$(".wallet_list .money").text();
            var inmoney=$(".suminp").val();
            if(parseInt(inmoney) > parseInt(maxMoney)){
                $(".errhide").removeClass('hide');
                $(".errhide").html("* 最大提款金额" + maxMoney + "元").show();
                $(".eveb_form_submit input").removeClass('button_1');
                $(".eveb_form_submit input").attr("disabled", true);
            }else{
                $(".errhide").removeClass('hide');
                $(".errhide").html('');
                $(".eveb_form_submit input").addClass('button_1');
                $(".eveb_form_submit input").attr("disabled", false);
            }

        });


        $("form[name='withdrawForm'] input[name='money']").change(function () {

        });


        $(".management_bank li div.accountSubStr").each(function (index, value) {
            var dataVal = $(this).attr('data-bank');
            var tempStr = '';
            var strVal = dataVal.toString();
            var startStr = strVal.substr(0, 4);
            var endStr = strVal.substr(strVal.length - 4, strVal.length);
            var middleStr = strVal.substr(4, strVal.length - 4);

            tempStr += startStr + " ";
            for(var i = 0; i < middleStr.length; i++){
                if(i == 3 && i != 0 || i == 7 && i != 0|| i == 11 && i != 0){
                    tempStr += '* ';
                }else {
                    tempStr += '*';
                }
            }
            tempStr += " " + endStr;

            $(this).html(tempStr);
        });

    });

    function setDefault(id) {
        ajaxRequest({
            url: "/member/ajaxSetDefault.json",
            data: {
                id: id
            },
            beforeSend: function() {
                parent.showLoading();
            },
            success: function(json) {
                parent.hideLoading();
                if (json.result == 1) {
                    location.reload();
                } else {
                    Tools.toast("操作失败：" + json.description);
                }
            }
        });
    }

    function ajaxDel(id) {
        if (confirm("确认删除")) {
            ajaxRequest({
                url: "/member/ajaxDelUserBank.json",
                data: {
                    id: id
                },
                beforeSend: function() {
                    parent.showLoading();
                },
                success: function(json) {
                    parent.hideLoading();
                    if (json.result == 1) {
                        Tools.toast("删除成功");
                        location.reload();
                    } else {
                        Tools.toast("删除失败：" + json.description);
                    }
                }
            });
        }
    }

    function refreshMoney() {
        ajaxRequest({
            url: "/user/ajaxGetMoney",
            beforeSend: function () {
                $(".eveb_transfer_box .money").html("刷新中");
            },
            success: function (json) {
                console.log(json);
                $(".money").html(json.coin);
                $("#wallet_1").html(json.valid);
            }
        });
    }

</script>
</body>
</html>