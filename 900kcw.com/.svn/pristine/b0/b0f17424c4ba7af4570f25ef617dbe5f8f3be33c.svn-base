$(function(){var b=new Date().getFullYear();$("#date").text(b+"年").dateTools();var a=$(".checked ").parent().attr("data-text")*1-1;console.log(a);addDataFun(b,a)});function dateAjax(b){console.log(b+"  时间改变做请求！");var a=$(".checked ").parent().attr("data-text")*1-1;console.log(a);addDataFun(b.replace("年",""),a)}$(".change_check").on("tap",function(){$(this).addClass("checked").parents().siblings().children(".checked").removeClass("checked");var a=$(this).parent().attr("data-text");console.log(a);var b="";if(a<=3){b=0.1}else{if(a==4){b=(-a+1)*0.45}else{if(a>=5){b=(-a+2)*0.45}}}if(b<-1.05){b=-1.05}$(".lz_type").css("left",b+"rem")});$(".change_check").on("touchmove",function(){$(".lz_type").css("left","");console.log("swipe")});function strokecanvas(d,f,A,g){var t=1084;$("#c1").attr("width",t);var h=f.length;var o=(t/772)*70*f.length;$("#c1").attr("height",o);var y=t*0.06666667,x=(t/750)*120,w=t*0.97333333;var m=t*0.04;var r={};var u=c1.getContext("2d");u.textBaseline="alphabetic";u.shadowBlur="";u.font="normal normal 100 "+t/750*30+"px PingFang SC Light";u.fillStyle="#333333";u.fillText("期数",y-m,(t/750)*35);u.beginPath();u.moveTo(t*0.12,(t/750)*15.5);u.lineTo(t*0.12,(t/750)*40.5);u.strokeStyle="#999";u.lineWidth=1;u.stroke();if(g){$("#c1").addClass("animated bounceInLeft")}else{$("#c1").addClass("animated bounceInRight")}var e=159;var j=[];for(var s=0;s<A.length;s++){j.push(e);console.log(j);u.fillStyle="#666666";u.fillText(A[s],e,(t/750)*35);e+=77.0833}u.beginPath();u.moveTo(0,(t/750)*55.5);u.lineTo(t,(t/750)*55.5);u.strokeStyle="#E0E0E0";u.lineWidth=1;u.stroke();function k(F,c,E,a,D,b){b=b===undefined?5:b;var p=a-c;var n=D-E;var C=Math.floor(Math.sqrt(p*p+n*n)/b);for(var B=0;B<C;++B){F[B%2===0?"moveTo":"lineTo"](c+(p/C)*B,E+(n/C)*B)}F.stroke()}u.translate(0.5,0.5);for(var v=0;v<f.length;v++){u.lineWidth=0.7;u.strokeStyle="#DADADA";u.beginPath();k(u,y+35,x,w,x,5.5);u.stroke();r[v]=x;u.fillStyle="#989898";u.font="normal normal 100 "+t/750*30+"px 微软雅黑 Regular";u.fillText(f[v],y-m,x+15);x+=(t/750)*65}console.log(r);u.beginPath();var l=((t*0.97333333)-(t*0.14666667))/50;console.log(l);var q=0;for(var q=0;q<d.length;q++){if(q==0){u.moveTo(j[d[q]]+20,r[q])}u.lineTo(j[d[q]]+20,r[q]);u.strokeStyle="#FA213C";u.lineWidth=1;if(q==h){clearInterval(abb)}u.lineJoin="bevel ";u.stroke();u.beginPath();u.moveTo(j[d[q]]+20,r[q]);if(q!=0){z(q-1);z(q)}}function z(a){u.font="normal normal 100 "+t/750*30+"px PingFang SC Light";u.beginPath();u.arc(j[d[a]]+20,r[a],+t/750*12,0,2*Math.PI);u.fillStyle="#FA213C";u.fill();u.fillStyle="#666";u.fillText(A[d[a]],j[d[a]]+20-10*2,r[a]-15*2)}}var old=0;function addDataFun(b,a){$.ajax({type:"get",url:url.apiurl+"smallSixMobile/findCZTrend.php",data:{year:b},dataType:"json",success:function(f){$(".change_check").on("tap",function(){$("#c1").removeClass("animated bounceInLeft bounceInRight");if(f.result.data==""){$("#c1").attr("height",1000);var j=c1.getContext("2d");j.clearRect(0,0,20000,20000);return false}var l=$(this).parent().attr("data-text");console.log(l,old);if(l>old){var m=false;old=l}else{var m=true;old=l}var h=f.result.data[l-1].axisX;var n=f.result.data[l-1].axisY;var k=[];$.each(f.result.data[l-1].items,function(o,q){k.push(q.y)});console.log();strokecanvas(k,h,n,m)});if(f.result.data==""){$("#c1").attr("height",1000);var d=c1.getContext("2d");d.clearRect(0,0,20000,20000);return false}console.log(f);var e=f.result.data[a].axisX;var g=f.result.data[a].axisY;var c=[];$.each(f.result.data[a].items,function(h,j){c.push(j.y)});strokecanvas(c,e,g,true)}})};